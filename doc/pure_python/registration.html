
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><title>Python: module registration</title>
<meta charset="utf-8">
</head><body bgcolor="#f0f0f8">

<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="heading">
<tr bgcolor="#7799ee">
<td valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial">&nbsp;<br><big><big><strong>registration</strong></big></big></font></td
><td align=right valign=bottom
><font color="#ffffff" face="helvetica, arial"><a href=".">index</a><br><a href="file:///C:/users/chenym/documents/dr/epilepsy_preprocessing/registration.py">c:\users\chenym\documents\dr\epilepsy_preprocessing\registration.py</a></font></td></tr></table>
    <p><tt>Created&nbsp;on&nbsp;Fri&nbsp;May&nbsp;05&nbsp;03:09:54&nbsp;2017<br>
&nbsp;<br>
@author:&nbsp;chenym<br>
&nbsp;<br>
some&nbsp;registration&nbsp;and&nbsp;co-registration</tt></p>
<p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#aa55cc">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Modules</strong></big></font></td></tr>
    
<tr><td bgcolor="#aa55cc"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><table width="100%" summary="list"><tr><td width="25%" valign=top><a href="nibabel.html">nibabel</a><br>
</td><td width="25%" valign=top><a href="numpy.html">numpy</a><br>
</td><td width="25%" valign=top><a href="warnings.html">warnings</a><br>
</td><td width="25%" valign=top></td></tr></table></td></tr></table><p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#eeaa77">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Functions</strong></big></font></td></tr>
    
<tr><td bgcolor="#eeaa77"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><dl><dt><a name="-affine_registration_nipy"><strong>affine_registration_nipy</strong></a>(in_path, ref_path, out_path, in_ref_mat<font color="#909090">=''</font>, ref_in_mat<font color="#909090">=''</font>, T<font color="#909090">=None</font>, extra_params<font color="#909090">={}</font>)</dt><dd><tt>Affine&nbsp;registation&nbsp;and&nbsp;resampling.&nbsp;Use&nbsp;Histogram&nbsp;registration&nbsp;from&nbsp;nipy.&nbsp;<br>
&nbsp;<br>
inputs:<br>
&nbsp;&nbsp;&nbsp;&nbsp;in_path:&nbsp;path&nbsp;to&nbsp;the&nbsp;source&nbsp;(input)&nbsp;image.<br>
&nbsp;&nbsp;&nbsp;&nbsp;ref_path:&nbsp;path&nbsp;to&nbsp;the&nbsp;target&nbsp;(reference)&nbsp;image.<br>
&nbsp;&nbsp;&nbsp;&nbsp;out_path:&nbsp;path&nbsp;to&nbsp;use&nbsp;to&nbsp;save&nbsp;the&nbsp;registered&nbsp;image.&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;in_ref_mat:&nbsp;if&nbsp;bool(in_ref_mat)&nbsp;is&nbsp;True,&nbsp;save&nbsp;the&nbsp;4x4&nbsp;transformation<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matrix&nbsp;to&nbsp;a&nbsp;text&nbsp;file&nbsp;&lt;in_ref_mat&gt;.&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;ref_in_mat:&nbsp;if&nbsp;bool(ref_in_mat)&nbsp;is&nbsp;True,&nbsp;save&nbsp;the&nbsp;reverse&nbsp;of&nbsp;the&nbsp;4x4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;transformation&nbsp;matrix&nbsp;to&nbsp;a&nbsp;text&nbsp;file&nbsp;&lt;ref_in_mat&gt;.&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;T:&nbsp;affine&nbsp;transformation&nbsp;to&nbsp;use.&nbsp;if&nbsp;None,&nbsp;T&nbsp;will&nbsp;be&nbsp;estimated&nbsp;using&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HistogramRegistration&nbsp;and&nbsp;optimizers;&nbsp;if&nbsp;type(T)&nbsp;is&nbsp;not&nbsp;Affine,&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T&nbsp;=&nbsp;Affine(array=T)<br>
&nbsp;&nbsp;&nbsp;&nbsp;extra_params:&nbsp;extra&nbsp;parameters&nbsp;passing&nbsp;to&nbsp;HistogramRegistration,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HistogramRegistration.optimize,&nbsp;resample<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
return&nbsp;T</tt></dd></dl>
 <dl><dt><a name="-affine_registration_pypreprocess"><strong>affine_registration_pypreprocess</strong></a>(in_path, ref_path, out_path, in_ref_mat<font color="#909090">=''</font>, ref_in_mat<font color="#909090">=''</font>, T<font color="#909090">=None</font>, force_resample<font color="#909090">=False</font>, extra_params<font color="#909090">={}</font>)</dt><dd><tt>Affine&nbsp;registation&nbsp;and&nbsp;resampling.&nbsp;Use&nbsp;Coregister&nbsp;from&nbsp;pypreprocess.&nbsp;<br>
&nbsp;<br>
Coregister&nbsp;is&nbsp;designed&nbsp;for&nbsp;transformation&nbsp;between&nbsp;func&nbsp;and&nbsp;anat,&nbsp;so&nbsp;applying<br>
this&nbsp;function&nbsp;to&nbsp;mni&nbsp;standard&nbsp;space&nbsp;may&nbsp;not&nbsp;produce&nbsp;the&nbsp;best&nbsp;result.<br>
&nbsp;<br>
inputs:<br>
&nbsp;&nbsp;&nbsp;&nbsp;in_path:&nbsp;path&nbsp;to&nbsp;the&nbsp;source&nbsp;(input)&nbsp;image.<br>
&nbsp;&nbsp;&nbsp;&nbsp;ref_path:&nbsp;path&nbsp;to&nbsp;the&nbsp;target&nbsp;(reference)&nbsp;image.<br>
&nbsp;&nbsp;&nbsp;&nbsp;out_path:&nbsp;path&nbsp;to&nbsp;use&nbsp;to&nbsp;save&nbsp;the&nbsp;registered&nbsp;image.&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;in_ref_mat:&nbsp;if&nbsp;bool(in_ref_mat)&nbsp;is&nbsp;True,&nbsp;save&nbsp;the&nbsp;4x4&nbsp;transformation<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matrix&nbsp;to&nbsp;a&nbsp;text&nbsp;file&nbsp;&lt;in_ref_mat&gt;.&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;ref_in_mat:&nbsp;if&nbsp;bool(ref_in_mat)&nbsp;is&nbsp;True,&nbsp;save&nbsp;the&nbsp;reverse&nbsp;of&nbsp;the&nbsp;4x4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;transformation&nbsp;matrix&nbsp;to&nbsp;a&nbsp;text&nbsp;file&nbsp;&lt;ref_in_mat&gt;.&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;T:&nbsp;specific&nbsp;transformation&nbsp;to&nbsp;use.&nbsp;if&nbsp;None,&nbsp;T&nbsp;will&nbsp;be&nbsp;estimated&nbsp;using&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Coregister().fit;&nbsp;else&nbsp;numpy.array(T)&nbsp;will&nbsp;be&nbsp;used.&nbsp;T&nbsp;is&nbsp;an&nbsp;array<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;6&nbsp;elements;&nbsp;the&nbsp;first&nbsp;three&nbsp;represent&nbsp;translation,&nbsp;and&nbsp;the&nbsp;last<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;three&nbsp;represent&nbsp;rotations.&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;force_resample:&nbsp;bool.&nbsp;whether&nbsp;or&nbsp;not&nbsp;to&nbsp;resample&nbsp;in&nbsp;an&nbsp;extra&nbsp;step.&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by&nbsp;default&nbsp;pypreprocess&nbsp;does&nbsp;not&nbsp;resample&nbsp;data,&nbsp;which&nbsp;means&nbsp;we&nbsp;have<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;use&nbsp;nilearn's&nbsp;module&nbsp;to&nbsp;do&nbsp;that.&nbsp;also&nbsp;scaling&nbsp;is&nbsp;not&nbsp;one&nbsp;of&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;provided&nbsp;DoF/estimation&nbsp;parameters&nbsp;of&nbsp;pypreprocess,&nbsp;neither&nbsp;did&nbsp;I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;implement&nbsp;it&nbsp;myself.&nbsp;maybe&nbsp;check&nbsp;scipy.misc.imresize&nbsp;if&nbsp;scaling&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;needs&nbsp;to&nbsp;be&nbsp;implemented&nbsp;in&nbsp;the&nbsp;future.&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;extra_params:&nbsp;for&nbsp;Coregister()</tt></dd></dl>
 <dl><dt><a name="-build_reg_output_path"><strong>build_reg_output_path</strong></a>(name_in, name_ref, reg_dir, name_conn)</dt><dd><tt>build&nbsp;the&nbsp;paths&nbsp;to&nbsp;3&nbsp;output&nbsp;files&nbsp;for&nbsp;each&nbsp;registration&nbsp;process.&nbsp;<br>
&nbsp;<br>
inputs:<br>
&nbsp;&nbsp;&nbsp;&nbsp;name_in,&nbsp;name_ref:&nbsp;name&nbsp;of&nbsp;files.&nbsp;str&nbsp;with&nbsp;no&nbsp;extention<br>
&nbsp;&nbsp;&nbsp;&nbsp;reg_dir:&nbsp;directory&nbsp;for&nbsp;load&nbsp;and&nbsp;save<br>
&nbsp;&nbsp;&nbsp;&nbsp;name_conn:&nbsp;string&nbsp;to&nbsp;bridge&nbsp;strings&nbsp;and&nbsp;show&nbsp;directions.&nbsp;e.g.&nbsp;2,&nbsp;_to_<br>
return:&nbsp;a&nbsp;list&nbsp;of&nbsp;file&nbsp;paths,&nbsp;with&nbsp;orders&nbsp;like&nbsp;this:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;['in2ref.nii.gz',&nbsp;'in2ref.mat',&nbsp;'ref2in.mat']</tt></dd></dl>
 <dl><dt><a name="-concat_transforms"><strong>concat_transforms</strong></a>(T1, T2, registration_to_use)</dt><dd><tt>use&nbsp;this&nbsp;to&nbsp;avoid&nbsp;the&nbsp;conversion&nbsp;between&nbsp;affine&nbsp;matrices&nbsp;and<br>
(translation,&nbsp;rotation)&nbsp;vectors.&nbsp;<br>
&nbsp;<br>
T1.dot(T2)&nbsp;for&nbsp;matrix&nbsp;(nipy)&nbsp;and&nbsp;T1&nbsp;+&nbsp;T2&nbsp;for&nbsp;vectors&nbsp;(pypreprocess)</tt></dd></dl>
 <dl><dt><a name="-get_registration_function"><strong>get_registration_function</strong></a>(registration_to_use)</dt></dl>
</td></tr></table><p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#55aa55">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Data</strong></big></font></td></tr>
    
<tr><td bgcolor="#55aa55"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><strong>REG_FUNC_OPTS</strong> = ['nipy', 'pypreprocess']</td></tr></table>
</body></html>