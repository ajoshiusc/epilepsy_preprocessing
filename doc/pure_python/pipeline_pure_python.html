
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><title>Python: module pipeline_pure_python</title>
<meta charset="utf-8">
</head><body bgcolor="#f0f0f8">

<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="heading">
<tr bgcolor="#7799ee">
<td valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial">&nbsp;<br><big><big><strong>pipeline_pure_python</strong></big></big></font></td
><td align=right valign=bottom
><font color="#ffffff" face="helvetica, arial"><a href=".">index</a><br><a href="file:///C:/users/chenym/documents/dr/epilepsy_preprocessing/pipeline_pure_python.py">c:\users\chenym\documents\dr\epilepsy_preprocessing\pipeline_pure_python.py</a></font></td></tr></table>
    <p><tt>Created&nbsp;on&nbsp;Tue&nbsp;Apr&nbsp;18&nbsp;22:33:16&nbsp;2017<br>
&nbsp;<br>
@author:&nbsp;chenym<br>
&nbsp;<br>
This&nbsp;file&nbsp;contains&nbsp;two&nbsp;runners.&nbsp;<a href="#-run_func_preproc">run_func_preproc</a>(...)&nbsp;for&nbsp;running&nbsp;(a&nbsp;selected<br>
subset&nbsp;of)&nbsp;func_preproc's&nbsp;functions&nbsp;in&nbsp;series,&nbsp;that&nbsp;will&nbsp;read&nbsp;a&nbsp;configuration,<br>
handle&nbsp;naming&nbsp;and&nbsp;I/Os,&nbsp;and&nbsp;adjust&nbsp;each&nbsp;function's&nbsp;parameters&nbsp;accordingly.&nbsp;<br>
&nbsp;<br>
Usage:<br>
<a href="#-run_func_preproc">run_func_preproc</a>('rest',&nbsp;'func')&nbsp;will&nbsp;apply&nbsp;functional&nbsp;pre-processing&nbsp;on<br>
image&nbsp;&lt;func/rest.nii.gz&gt;&nbsp;using&nbsp;default&nbsp;settings,&nbsp;and&nbsp;save&nbsp;intermediate&nbsp;outputs<br>
to&nbsp;&lt;func/&gt;&nbsp;using&nbsp;default&nbsp;naming&nbsp;style.&nbsp;On&nbsp;the&nbsp;other&nbsp;hand,&nbsp;<br>
<a href="#-run_func_preproc">run_func_preproc</a>(<br>
&nbsp;&nbsp;&nbsp;&nbsp;'rest',&nbsp;'func',<br>
&nbsp;&nbsp;&nbsp;&nbsp;smooth&nbsp;=&nbsp;6,&nbsp;force_mean_reference&nbsp;=&nbsp;True,<br>
&nbsp;&nbsp;&nbsp;&nbsp;func_to_run=['motion_correction','skullstrip4d','smoothing_scaling'],<br>
&nbsp;&nbsp;&nbsp;&nbsp;naming={'skullstrip4d_name_postfix':'ss_2'},<br>
&nbsp;&nbsp;&nbsp;&nbsp;extra_params={'compute_epi_mask':{'lower_cutoff':0.4,&nbsp;'upper_cutoff':0.7}}<br>
&nbsp;&nbsp;&nbsp;&nbsp;)<br>
will&nbsp;apply&nbsp;three&nbsp;steps:&nbsp;motion&nbsp;correction&nbsp;then&nbsp;skull&nbsp;stripping&nbsp;then&nbsp;smoothing;<br>
the&nbsp;motion&nbsp;correction&nbsp;will&nbsp;be&nbsp;referenced&nbsp;to&nbsp;the&nbsp;mean,&nbsp;as&nbsp;indicated&nbsp;by<br>
force_mean_reference&nbsp;=&nbsp;True;&nbsp;the&nbsp;skull&nbsp;stripping&nbsp;will&nbsp;include&nbsp;more&nbsp;"brain",&nbsp;as<br>
indicated&nbsp;by&nbsp;compute_epi_mask's&nbsp;extra&nbsp;parameters,&nbsp;and&nbsp;the&nbsp;final&nbsp;skull&nbsp;stripped<br>
image&nbsp;will&nbsp;be&nbsp;saved&nbsp;to&nbsp;&lt;func/rest_ss_2.nii.gz&gt;&nbsp;instead&nbsp;of&nbsp;the&nbsp;default<br>
&lt;func/rest_ss_.nii.gz&gt;.&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
run_registration&nbsp;for&nbsp;registrating&nbsp;functional&nbsp;image&nbsp;to&nbsp;mni&nbsp;standard&nbsp;space.&nbsp;It&nbsp;<br>
first&nbsp;registers&nbsp;functional&nbsp;image&nbsp;to&nbsp;anatomical&nbsp;image,&nbsp;then&nbsp;registers&nbsp;anatomical<br>
image&nbsp;to&nbsp;mni&nbsp;image.&nbsp;Finally,&nbsp;it&nbsp;registers&nbsp;the&nbsp;functional&nbsp;image&nbsp;to&nbsp;mni&nbsp;image&nbsp;by<br>
concatinating&nbsp;the&nbsp;affine&nbsp;transformation&nbsp;obtained&nbsp;in&nbsp;the&nbsp;first&nbsp;two&nbsp;steps&nbsp;and<br>
applying&nbsp;directly&nbsp;to&nbsp;the&nbsp;functional&nbsp;image.&nbsp;<br>
&nbsp;<br>
Usage:<br>
<a href="#-run_registration">run_registration</a>('highres',&nbsp;'example_func',&nbsp;'standard',&nbsp;'reg')&nbsp;will&nbsp;load<br>
&lt;reg/highres.nii.gz&gt;&nbsp;as&nbsp;anatomical&nbsp;scan,&nbsp;&lt;reg/examle_func.nii.gz&gt;&nbsp;as&nbsp;example<br>
functional&nbsp;scan,&nbsp;and&nbsp;&lt;reg/standard.nii.gz&gt;&nbsp;as&nbsp;mni&nbsp;template.&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
Finally,&nbsp;the&nbsp;main&nbsp;function&nbsp;will&nbsp;run&nbsp;these&nbsp;two&nbsp;runners.&nbsp;It&nbsp;can&nbsp;be&nbsp;run&nbsp;in&nbsp;a<br>
command&nbsp;line&nbsp;prompt&nbsp;too.&nbsp;<br>
&nbsp;<br>
Usage:</tt></p>
<p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#aa55cc">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Modules</strong></big></font></td></tr>
    
<tr><td bgcolor="#aa55cc"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><table width="100%" summary="list"><tr><td width="25%" valign=top><a href="argparse.html">argparse</a><br>
<a href="func_preproc.html">func_preproc</a><br>
</td><td width="25%" valign=top><a href="json.html">json</a><br>
<a href="os.html">os</a><br>
</td><td width="25%" valign=top><a href="re.html">re</a><br>
<a href="registration.html">registration</a><br>
</td><td width="25%" valign=top><a href="shutil.html">shutil</a><br>
</td></tr></table></td></tr></table><p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#eeaa77">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Functions</strong></big></font></td></tr>
    
<tr><td bgcolor="#eeaa77"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><dl><dt><a name="-main"><strong>main</strong></a>(args)</dt><dd><tt>main&nbsp;function.&nbsp;run&nbsp;functional,&nbsp;then&nbsp;create&nbsp;reg&nbsp;dir,&nbsp;copy&nbsp;files,&nbsp;and&nbsp;run<br>
registration.&nbsp;<br>
&nbsp;<br>
args:&nbsp;containing&nbsp;input&nbsp;arguments</tt></dd></dl>
 <dl><dt><a name="-run_func_preproc"><strong>run_func_preproc</strong></a>(rest_name, func_dir, naming<font color="#909090">={}</font>, func_to_run<font color="#909090">='default'</font>, extra_params<font color="#909090">={}</font>, example_path_list<font color="#909090">=[]</font>, **kwargs)</dt></dl>
 <dl><dt><a name="-run_registration"><strong>run_registration</strong></a>(anat_name, func_name, mni_name, reg_dir, registration_to_use<font color="#909090">='nipy'</font>, _nb<font color="#909090">='2'</font>, extra_params<font color="#909090">={}</font>)</dt><dd><tt>registration&nbsp;workflow.&nbsp;will&nbsp;register&nbsp;func&nbsp;to&nbsp;anat,&nbsp;then&nbsp;anat&nbsp;to&nbsp;stanard,<br>
and&nbsp;finally&nbsp;func&nbsp;to&nbsp;standard.&nbsp;<br>
&nbsp;<br>
inputs:<br>
&nbsp;&nbsp;&nbsp;&nbsp;anat_name,&nbsp;func_name,&nbsp;mni_name:&nbsp;name&nbsp;of&nbsp;3D&nbsp;scans,&nbsp;not&nbsp;extension.&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;reg_dir:&nbsp;directory<br>
&nbsp;&nbsp;&nbsp;&nbsp;registration_to_use:&nbsp;can&nbsp;choose&nbsp;from&nbsp;['nipy',&nbsp;'pypreprocess']<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;will&nbsp;raise&nbsp;error&nbsp;if&nbsp;the&nbsp;package&nbsp;of&nbsp;interest&nbsp;can't&nbsp;be&nbsp;imported<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'pypreprocess'&nbsp;does&nbsp;not&nbsp;resample&nbsp;the&nbsp;source&nbsp;image&nbsp;into&nbsp;registered&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;space&nbsp;by&nbsp;default.&nbsp;in&nbsp;order&nbsp;to&nbsp;override&nbsp;that,&nbsp;one&nbsp;has&nbsp;to&nbsp;pass<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;force_resample=True&nbsp;through&nbsp;extra_params,&nbsp;and&nbsp;the&nbsp;image&nbsp;still&nbsp;won't<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;be&nbsp;scaled&nbsp;in&nbsp;the&nbsp;end.&nbsp;so&nbsp;use&nbsp;with&nbsp;caution.&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;_nb:&nbsp;str&nbsp;to&nbsp;combine&nbsp;source&nbsp;and&nbsp;target&nbsp;name.&nbsp;e.g.&nbsp;highres&lt;2&gt;standard<br>
&nbsp;&nbsp;&nbsp;&nbsp;extra_params:&nbsp;extra&nbsp;parameters&nbsp;to&nbsp;pass&nbsp;to&nbsp;functions.&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;format:&nbsp;extra_params&nbsp;=&nbsp;{'func_name':{'param_keyword':'value'}}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.g.&nbsp;extra_params&nbsp;=&nbsp;{'optimize':{'optimizer':'steepest'}}&nbsp;will&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;override&nbsp;the&nbsp;default&nbsp;optimizer&nbsp;for&nbsp;the&nbsp;optimize&nbsp;function.&nbsp;This&nbsp;works<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;on&nbsp;classes&nbsp;too,&nbsp;e.g.&nbsp;extra_params&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{'HistogramRegistration':&nbsp;{'smooth':6}}&nbsp;is&nbsp;equivalent&nbsp;to<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HistogramRegistration(smooth=6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;positional&nbsp;arguments&nbsp;will&nbsp;be&nbsp;preserved&nbsp;and&nbsp;keyword&nbsp;arguments&nbsp;will&nbsp;be<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;override.&nbsp;TypeError&nbsp;will&nbsp;raise&nbsp;if&nbsp;extra&nbsp;parameters&nbsp;did&nbsp;not&nbsp;fit.</tt></dd></dl>
</td></tr></table>
</body></html>